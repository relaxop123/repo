<script>
    document.getElementById('sendLocationButton').addEventListener('click', async function() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(async position => {
                let lat = position.coords.latitude;
                let lon = position.coords.longitude;
                let data = JSON.stringify({ latitude: lat, longitude: lon, user: userAccount });

                const result = await ipfs.add(data);
                let ipfsHash = result.path;
                let ipfsLink = `https://ipfs.io/ipfs/${ipfsHash}`;
                let message = `Bon voyage ! üá™üá∏ Voici votre itin√©raire s√©curis√© : ${ipfsLink}`;

                // G√©n√©rer le lien WhatsApp
                let whatsappUrl = `https://wa.me/33605993097?text=${encodeURIComponent(message)}`;

                // Ouvrir WhatsApp imm√©diatement apr√®s le clic
                window.open(whatsappUrl, '_blank');

                alert("Donn√©es stock√©es sur IPFS et envoy√©es via WhatsApp !");
            }, () => {
                alert("Impossible de r√©cup√©rer votre position.");
            });
        } else {
            alert("Votre navigateur ne supporte pas la g√©olocalisation.");
        }
    });
</script>
